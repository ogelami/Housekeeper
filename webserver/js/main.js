//let weatherChunk = {"cod":"200","message":0,"cnt":40,"list":[{"dt":1588442400,"main":{"temp":11.55,"feels_like":8.32,"temp_min":9.49,"temp_max":11.55,"pressure":1002,"sea_level":1002,"grnd_level":1000,"humidity":62,"temp_kf":2.06},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":65},"wind":{"speed":2.87,"deg":193},"sys":{"pod":"d"},"dt_txt":"2020-05-02 18:00:00"},{"dt":1588453200,"main":{"temp":9.03,"feels_like":6.37,"temp_min":7.79,"temp_max":9.03,"pressure":1003,"sea_level":1003,"grnd_level":1000,"humidity":73,"temp_kf":1.24},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":90},"wind":{"speed":2.04,"deg":189},"sys":{"pod":"n"},"dt_txt":"2020-05-02 21:00:00"},{"dt":1588464000,"main":{"temp":7.62,"feels_like":5.14,"temp_min":7.22,"temp_max":7.62,"pressure":1004,"sea_level":1004,"grnd_level":1001,"humidity":80,"temp_kf":0.4},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":97},"wind":{"speed":1.76,"deg":229},"sys":{"pod":"n"},"dt_txt":"2020-05-03 00:00:00"},{"dt":1588474800,"main":{"temp":7.62,"feels_like":5.9,"temp_min":7.57,"temp_max":7.62,"pressure":1004,"sea_level":1004,"grnd_level":1001,"humidity":83,"temp_kf":0.05},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":100},"wind":{"speed":0.83,"deg":311},"rain":{"3h":0.37},"sys":{"pod":"d"},"dt_txt":"2020-05-03 03:00:00"},{"dt":1588485600,"main":{"temp":10.09,"feels_like":8.12,"temp_min":10.09,"temp_max":10.09,"pressure":1005,"sea_level":1005,"grnd_level":1003,"humidity":70,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":91},"wind":{"speed":1.17,"deg":186},"sys":{"pod":"d"},"dt_txt":"2020-05-03 06:00:00"},{"dt":1588496400,"main":{"temp":14.12,"feels_like":12.92,"temp_min":14.12,"temp_max":14.12,"pressure":1006,"sea_level":1006,"grnd_level":1004,"humidity":56,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":56},"wind":{"speed":0.25,"deg":166},"sys":{"pod":"d"},"dt_txt":"2020-05-03 09:00:00"},{"dt":1588507200,"main":{"temp":14.32,"feels_like":12.11,"temp_min":14.32,"temp_max":14.32,"pressure":1007,"sea_level":1007,"grnd_level":1004,"humidity":58,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":50},"wind":{"speed":1.9,"deg":170},"rain":{"3h":1.46},"sys":{"pod":"d"},"dt_txt":"2020-05-03 12:00:00"},{"dt":1588518000,"main":{"temp":13.2,"feels_like":10.45,"temp_min":13.2,"temp_max":13.2,"pressure":1006,"sea_level":1006,"grnd_level":1004,"humidity":65,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":83},"wind":{"speed":2.86,"deg":196},"rain":{"3h":2.01},"sys":{"pod":"d"},"dt_txt":"2020-05-03 15:00:00"},{"dt":1588528800,"main":{"temp":10.07,"feels_like":8.1,"temp_min":10.07,"temp_max":10.07,"pressure":1007,"sea_level":1007,"grnd_level":1004,"humidity":80,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":91},"wind":{"speed":1.75,"deg":178},"rain":{"3h":1.24},"sys":{"pod":"d"},"dt_txt":"2020-05-03 18:00:00"},{"dt":1588539600,"main":{"temp":7.24,"feels_like":4.94,"temp_min":7.24,"temp_max":7.24,"pressure":1007,"sea_level":1007,"grnd_level":1005,"humidity":87,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":34},"wind":{"speed":1.75,"deg":143},"sys":{"pod":"n"},"dt_txt":"2020-05-03 21:00:00"},{"dt":1588550400,"main":{"temp":6.65,"feels_like":4.5,"temp_min":6.65,"temp_max":6.65,"pressure":1008,"sea_level":1008,"grnd_level":1005,"humidity":87,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":39},"wind":{"speed":1.36,"deg":162},"sys":{"pod":"n"},"dt_txt":"2020-05-04 00:00:00"},{"dt":1588561200,"main":{"temp":6.04,"feels_like":3.9,"temp_min":6.04,"temp_max":6.04,"pressure":1007,"sea_level":1007,"grnd_level":1005,"humidity":89,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":49},"wind":{"speed":1.27,"deg":219},"sys":{"pod":"d"},"dt_txt":"2020-05-04 03:00:00"},{"dt":1588572000,"main":{"temp":8.77,"feels_like":6.43,"temp_min":8.77,"temp_max":8.77,"pressure":1007,"sea_level":1007,"grnd_level":1005,"humidity":79,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":67},"wind":{"speed":1.83,"deg":236},"sys":{"pod":"d"},"dt_txt":"2020-05-04 06:00:00"},{"dt":1588582800,"main":{"temp":11.68,"feels_like":8.57,"temp_min":11.68,"temp_max":11.68,"pressure":1007,"sea_level":1007,"grnd_level":1005,"humidity":58,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":99},"wind":{"speed":2.48,"deg":222},"sys":{"pod":"d"},"dt_txt":"2020-05-04 09:00:00"},{"dt":1588593600,"main":{"temp":13.38,"feels_like":9.74,"temp_min":13.38,"temp_max":13.38,"pressure":1008,"sea_level":1008,"grnd_level":1005,"humidity":45,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":84},"wind":{"speed":2.73,"deg":219},"sys":{"pod":"d"},"dt_txt":"2020-05-04 12:00:00"},{"dt":1588604400,"main":{"temp":12.64,"feels_like":8.11,"temp_min":12.64,"temp_max":12.64,"pressure":1007,"sea_level":1007,"grnd_level":1005,"humidity":45,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":77},"wind":{"speed":3.86,"deg":194},"sys":{"pod":"d"},"dt_txt":"2020-05-04 15:00:00"},{"dt":1588615200,"main":{"temp":9.19,"feels_like":6.97,"temp_min":9.19,"temp_max":9.19,"pressure":1008,"sea_level":1008,"grnd_level":1005,"humidity":63,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":74},"wind":{"speed":0.91,"deg":222},"sys":{"pod":"d"},"dt_txt":"2020-05-04 18:00:00"},{"dt":1588626000,"main":{"temp":6.53,"feels_like":3.68,"temp_min":6.53,"temp_max":6.53,"pressure":1008,"sea_level":1008,"grnd_level":1006,"humidity":81,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04n"}],"clouds":{"all":57},"wind":{"speed":2.06,"deg":4},"sys":{"pod":"n"},"dt_txt":"2020-05-04 21:00:00"},{"dt":1588636800,"main":{"temp":5.17,"feels_like":2.13,"temp_min":5.17,"temp_max":5.17,"pressure":1009,"sea_level":1009,"grnd_level":1006,"humidity":87,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":65},"wind":{"speed":2.25,"deg":12},"rain":{"3h":0.12},"sys":{"pod":"n"},"dt_txt":"2020-05-05 00:00:00"},{"dt":1588647600,"main":{"temp":4.72,"feels_like":1.55,"temp_min":4.72,"temp_max":4.72,"pressure":1009,"sea_level":1009,"grnd_level":1007,"humidity":86,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":93},"wind":{"speed":2.28,"deg":19},"sys":{"pod":"d"},"dt_txt":"2020-05-05 03:00:00"},{"dt":1588658400,"main":{"temp":8.36,"feels_like":4.38,"temp_min":8.36,"temp_max":8.36,"pressure":1011,"sea_level":1011,"grnd_level":1008,"humidity":65,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":80},"wind":{"speed":3.33,"deg":35},"sys":{"pod":"d"},"dt_txt":"2020-05-05 06:00:00"},{"dt":1588669200,"main":{"temp":11.76,"feels_like":7.02,"temp_min":11.76,"temp_max":11.76,"pressure":1012,"sea_level":1012,"grnd_level":1010,"humidity":48,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":8},"wind":{"speed":4.18,"deg":48},"sys":{"pod":"d"},"dt_txt":"2020-05-05 09:00:00"},{"dt":1588680000,"main":{"temp":13,"feels_like":8.26,"temp_min":13,"temp_max":13,"pressure":1014,"sea_level":1014,"grnd_level":1011,"humidity":41,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":5},"wind":{"speed":3.94,"deg":63},"sys":{"pod":"d"},"dt_txt":"2020-05-05 12:00:00"},{"dt":1588690800,"main":{"temp":12.29,"feels_like":7.97,"temp_min":12.29,"temp_max":12.29,"pressure":1014,"sea_level":1014,"grnd_level":1011,"humidity":47,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":35},"wind":{"speed":3.62,"deg":44},"sys":{"pod":"d"},"dt_txt":"2020-05-05 15:00:00"},{"dt":1588701600,"main":{"temp":9.32,"feels_like":5.57,"temp_min":9.32,"temp_max":9.32,"pressure":1015,"sea_level":1015,"grnd_level":1012,"humidity":71,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":58},"wind":{"speed":3.56,"deg":5},"sys":{"pod":"d"},"dt_txt":"2020-05-05 18:00:00"},{"dt":1588712400,"main":{"temp":5.63,"feels_like":1.72,"temp_min":5.63,"temp_max":5.63,"pressure":1015,"sea_level":1015,"grnd_level":1012,"humidity":80,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":42},"wind":{"speed":3.3,"deg":354},"sys":{"pod":"n"},"dt_txt":"2020-05-05 21:00:00"},{"dt":1588723200,"main":{"temp":4.54,"feels_like":0.32,"temp_min":4.54,"temp_max":4.54,"pressure":1015,"sea_level":1015,"grnd_level":1012,"humidity":76,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":34},"wind":{"speed":3.34,"deg":336},"sys":{"pod":"n"},"dt_txt":"2020-05-06 00:00:00"},{"dt":1588734000,"main":{"temp":4.08,"feels_like":-0.02,"temp_min":4.08,"temp_max":4.08,"pressure":1015,"sea_level":1015,"grnd_level":1012,"humidity":73,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":39},"wind":{"speed":2.95,"deg":337},"sys":{"pod":"d"},"dt_txt":"2020-05-06 03:00:00"},{"dt":1588744800,"main":{"temp":6.94,"feels_like":2.71,"temp_min":6.94,"temp_max":6.94,"pressure":1015,"sea_level":1015,"grnd_level":1012,"humidity":59,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":70},"wind":{"speed":3.1,"deg":328},"sys":{"pod":"d"},"dt_txt":"2020-05-06 06:00:00"},{"dt":1588755600,"main":{"temp":11.64,"feels_like":7.7,"temp_min":11.64,"temp_max":11.64,"pressure":1015,"sea_level":1015,"grnd_level":1012,"humidity":43,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":99},"wind":{"speed":2.68,"deg":323},"sys":{"pod":"d"},"dt_txt":"2020-05-06 09:00:00"},{"dt":1588766400,"main":{"temp":13.99,"feels_like":10.15,"temp_min":13.99,"temp_max":13.99,"pressure":1014,"sea_level":1014,"grnd_level":1011,"humidity":40,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":73},"wind":{"speed":2.78,"deg":287},"sys":{"pod":"d"},"dt_txt":"2020-05-06 12:00:00"},{"dt":1588777200,"main":{"temp":13.99,"feels_like":10.88,"temp_min":13.99,"temp_max":13.99,"pressure":1012,"sea_level":1012,"grnd_level":1010,"humidity":43,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":39},"wind":{"speed":1.96,"deg":289},"sys":{"pod":"d"},"dt_txt":"2020-05-06 15:00:00"},{"dt":1588788000,"main":{"temp":11.31,"feels_like":9.08,"temp_min":11.31,"temp_max":11.31,"pressure":1012,"sea_level":1012,"grnd_level":1009,"humidity":58,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":57},"wind":{"speed":1.13,"deg":228},"sys":{"pod":"d"},"dt_txt":"2020-05-06 18:00:00"},{"dt":1588798800,"main":{"temp":8.21,"feels_like":5.55,"temp_min":8.21,"temp_max":8.21,"pressure":1012,"sea_level":1012,"grnd_level":1009,"humidity":70,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10n"}],"clouds":{"all":75},"wind":{"speed":1.67,"deg":47},"rain":{"3h":0.11},"sys":{"pod":"n"},"dt_txt":"2020-05-06 21:00:00"},{"dt":1588809600,"main":{"temp":6.34,"feels_like":1.85,"temp_min":6.34,"temp_max":6.34,"pressure":1013,"sea_level":1013,"grnd_level":1010,"humidity":68,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":49},"wind":{"speed":3.77,"deg":359},"sys":{"pod":"n"},"dt_txt":"2020-05-07 00:00:00"},{"dt":1588820400,"main":{"temp":4.56,"feels_like":-0.11,"temp_min":4.56,"temp_max":4.56,"pressure":1013,"sea_level":1013,"grnd_level":1011,"humidity":69,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":97},"wind":{"speed":3.7,"deg":344},"sys":{"pod":"d"},"dt_txt":"2020-05-07 03:00:00"},{"dt":1588831200,"main":{"temp":6.54,"feels_like":1.4,"temp_min":6.54,"temp_max":6.54,"pressure":1013,"sea_level":1013,"grnd_level":1010,"humidity":59,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":74},"wind":{"speed":4.32,"deg":336},"sys":{"pod":"d"},"dt_txt":"2020-05-07 06:00:00"},{"dt":1588842000,"main":{"temp":9.52,"feels_like":4.5,"temp_min":9.52,"temp_max":9.52,"pressure":1013,"sea_level":1013,"grnd_level":1010,"humidity":48,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":1},"wind":{"speed":4.14,"deg":314},"sys":{"pod":"d"},"dt_txt":"2020-05-07 09:00:00"},{"dt":1588852800,"main":{"temp":11.23,"feels_like":6.42,"temp_min":11.23,"temp_max":11.23,"pressure":1012,"sea_level":1012,"grnd_level":1009,"humidity":43,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":{"all":35},"wind":{"speed":3.86,"deg":292},"sys":{"pod":"d"},"dt_txt":"2020-05-07 12:00:00"},{"dt":1588863600,"main":{"temp":12.02,"feels_like":7.05,"temp_min":12.02,"temp_max":12.02,"pressure":1010,"sea_level":1010,"grnd_level":1007,"humidity":41,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":88},"wind":{"speed":4.09,"deg":302},"sys":{"pod":"d"},"dt_txt":"2020-05-07 15:00:00"}],"city":{"id":2719111,"name":"Bromma","coord":{"lat":59.34,"lon":17.94},"country":"SE","population":61000,"timezone":7200,"sunrise":1588387549,"sunset":1588445064}};

function refreshWeather(chunk)
{
  document.dispatchEvent(new CustomEvent('updateWeather', {'detail' : chunk}));
}

(() => {
  let realTimeClock = document.querySelector('.real-time-clock');

  let weatherIcon = document.querySelector('.weather .icon');
  let weatherDescription = document.querySelector('.weather .description');
  let weatherTemperature = document.querySelector('.weather .temperature');

  let buttonRefreshWeather = document.querySelector('button#refresh-weather');

  let overlay = document.querySelector('div#overlay');
  let overlayTimeout;

  function bumpOverlayTimeout()
  {
    clearTimeout(overlayTimeout);

    overlay.style.display = 'none';

    overlayTimeout = setTimeout(() => {
      overlay.style.display = 'block';
    }, 10000);
  }

  buttonRefreshWeather.addEventListener('click', () => {
    let s = document.createElement('script');
    s.src = 'http://api.openweathermap.org/data/2.5/forecast?lat=59.3399171&lon=17.929966&units=metric&appid=77d3554578ebbd354a066713c397ce84&callback=refreshWeather';
    document.body.appendChild(s);
  });

/*  overlay.addEventListener('click', () => {
    overlay.style.display = 'none';

    
  });*/

  //interaction timeout push
  document.addEventListener('click', () => bumpOverlayTimeout());

  document.addEventListener('updateWeather', (weather) => {
    weatherChunk = weather.detail;

    weatherIcon.src = `/img/openweathermap/${weatherChunk.list[0].weather[0].icon}@2x.png`;
    weatherDescription.innerText = `${weatherChunk.list[0].weather[0].description}`;
    weatherTemperature.innerText = `${weatherChunk.list[0].main.temp} °C`
  });

  setInterval(() =>
  {
    realTimeClock.innerText = new Date().toLocaleString("sv-SE", {timeZone: "Europe/Stockholm"});
  }, 500);
})();
